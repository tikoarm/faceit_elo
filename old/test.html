<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Result</title>

	<link rel="stylesheet" type="text/css" href="./styles/main.css">
	<link href="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap" rel="stylesheet">
</head>
<body>

	Lorem ipsum dolor sit amet consectetur adipisicing elit. Error eos veritatis consequuntur dolore iure suscipit, dignissimos ut modi magnam molestias esse nam quibusdam unde sunt impedit illo at maxime harum enim? Corrupti pariatur facilis vitae repellat ut! Suscipit pariatur facilis, odit, dolores a ratione cupiditate ullam laboriosam laudantium, voluptas nostrum perferendis rerum delectus doloremque dignissimos eum sint voluptates consequatur doloribus labore cum. Qui perferendis est possimus veniam quisquam labore excepturi ad necessitatibus asperiores. Ipsum, aut labore iste saepe enim et, consequuntur id sit reiciendis ut quo, quisquam, dolorum tempora dicta. Dicta reprehenderit doloremque reiciendis maxime. Consectetur officia incidunt nihil, iure velit quis magnam, dignissimos animi, id quas, molestiae fugit officiis! Fuga excepturi aliquid tempora ex. Delectus ipsam asperiores amet vel, eligendi! At animi temporibus, quam consequuntur corporis optio illo aliquam eveniet tempora voluptates, earum consectetur asperiores! Nobis minima a possimus, minus autem architecto ullam facere ipsum doloremque officia animi recusandae deserunt reiciendis molestias obcaecati ut blanditiis, sunt. Quaerat id quis nihil, sequi impedit ipsam. Quod incidunt repudiandae, libero quasi tempora quaerat sed error repellat quos unde nam fuga, quis labore fugiat sunt eos, veritatis. Quo totam mollitia, quidem quis soluta saepe debitis commodi alias nesciunt voluptatem, architecto, enim! Repudiandae suscipit cupiditate unde ipsum, tenetur nobis odio? Facilis iure corporis nihil natus. Placeat eligendi repudiandae enim itaque recusandae tempore ipsam sunt quod qui? Praesentium libero voluptate animi neque similique. Corporis quo aliquam maiores laudantium vero atque minus quod perspiciatis, necessitatibus consequuntur dolorem excepturi, doloremque. Numquam perspiciatis necessitatibus porro omnis odit vitae labore impedit fugiat saepe id consequatur, eligendi vero aspernatur dolorum magni quam quaerat velit adipisci dolore possimus facere alias sed autem. Doloribus rerum accusamus eveniet eligendi, deleniti tenetur, ipsum beatae! In impedit aliquid eius quo voluptate ab earum vitae, rerum. Dolore doloribus assumenda obcaecati esse iste animi natus ipsa sequi, maxime perferendis blanditiis provident, necessitatibus. Debitis libero odio, esse tempore quidem ipsa quis rem quae, ratione nostrum, et, voluptatum ullam aliquam nemo natus est nisi harum voluptas voluptates itaque sapiente eaque vitae accusamus dolorum perferendis? Velit, sunt autem voluptatum maiores consequuntur error, laboriosam laborum corporis hic? Adipisci temporibus ipsam perspiciatis voluptatum, iusto et maxime nemo vel suscipit dolore excepturi dolorum placeat consequatur esse earum voluptatem quo minus expedita debitis necessitatibus harum nostrum veritatis? Enim consequuntur totam mollitia laboriosam maiores incidunt ad asperiores, officia recusandae, natus labore officiis a aspernatur dolorem sint rerum voluptates eaque, iure neque explicabo cupiditate obcaecati atque fugiat ab temporibus? Possimus sequi pariatur nam ratione neque officia fuga provident magni deserunt saepe illum minima impedit ipsam iure iusto quisquam dignissimos accusamus, perferendis quas tempora dolore nemo est. Quibusdam repudiandae accusantium tenetur asperiores cupiditate, rem qui inventore saepe atque sit veniam omnis aliquid nemo vero voluptatibus ab ipsa magnam, optio. Quis molestiae perspiciatis perferendis ex impedit obcaecati consequatur veniam laboriosam minus ut quidem exercitationem fuga inventore tempora, laborum! Labore sequi illo vel optio minus, nesciunt quo perspiciatis ullam, dicta minima sit sed accusantium eius aliquid impedit. Sint voluptates voluptate explicabo, ut atque consectetur, dolor nihil, quae quos accusamus nulla enim iure ex placeat itaque. At, deleniti itaque reiciendis, nostrum a nulla nesciunt aut, mollitia cum ipsam eos nobis deserunt odio repellat sunt perspiciatis, nisi ipsa maxime! Eligendi magnam dignissimos qui fugiat pariatur voluptatum, officiis, provident nihil aliquam quod esse obcaecati minima ipsa nemo, eius sapiente dolorem non quaerat tempora temporibus libero? Nam autem delectus ullam laboriosam quam rerum accusamus, hic consequuntur esse labore quis, error id minima, soluta ratione dolores non. Quae blanditiis sunt quod velit voluptatum natus consectetur illum autem eum rem eos, alias voluptas obcaecati repellendus veritatis minima reiciendis ea dignissimos enim tempore! Pariatur illo, deleniti sint, aperiam corrupti harum voluptatem explicabo nihil omnis. Veritatis dignissimos quod eos earum assumenda autem minima labore quia pariatur sit dolorum ab delectus laborum quasi cumque sint dolores fuga rem, ratione optio velit, corrupti, adipisci, nihil laudantium. Dolore maxime et necessitatibus modi facilis omnis, tenetur laborum, rerum quis, quos quisquam quaerat vitae repudiandae, ea nulla. Voluptas reprehenderit mollitia sint unde, architecto magni inventore, illo quia aliquam perspiciatis ipsam dolorem aliquid magnam molestiae sit velit porro ut ratione earum culpa. Provident vel fugit, ullam fugiat, totam expedita. Cupiditate quis maxime, voluptatibus laborum iusto veritatis unde corrupti earum culpa molestiae perferendis ipsam, cum exercitationem vero id, mollitia. Eos quasi deleniti porro ipsam nobis, tempora deserunt optio neque suscipit, commodi vitae qui saepe placeat quod nostrum ullam voluptatum doloribus aliquid quisquam, perspiciatis nihil recusandae quis. Dolores asperiores consequuntur dolorem animi sequi, accusamus voluptas, expedita consequatur numquam perspiciatis doloribus, iusto ea nobis nam. Placeat, pariatur fugiat rerum quibusdam quisquam iusto voluptas laudantium earum facilis labore itaque suscipit accusamus quidem vitae quo ullam, soluta nobis autem sint, veniam. Similique distinctio at inventore ratione asperiores doloremque, sed voluptatibus necessitatibus laboriosam earum odio blanditiis, recusandae repellat vel perferendis reiciendis deleniti minima consectetur aliquam saepe. Assumenda officiis sed quasi facilis illum perferendis illo odio quas, omnis sunt consectetur aliquam itaque cupiditate harum delectus beatae neque provident explicabo, natus culpa? Eveniet obcaecati sed dolor delectus voluptatem error eligendi, veritatis illum reiciendis neque et porro excepturi esse explicabo at voluptas libero doloribus, labore quia, mollitia? Magnam fugiat nisi quis dignissimos facilis earum doloremque repellat alias sint praesentium, vel maxime doloribus, vitae iure, necessitatibus recusandae sed accusantium, iusto consequatur sunt dolor? Harum, ex repellat magni qui autem veritatis obcaecati quae non cum impedit accusamus magnam architecto quo quam maiores! Debitis sit consequuntur enim reiciendis nobis delectus nesciunt laboriosam ipsam expedita dolore, consectetur possimus beatae atque sunt ex assumenda aspernatur vitae, ratione consequatur eligendi fugiat odit cupiditate obcaecati optio. Cupiditate, necessitatibus neque voluptate eos ducimus adipisci natus molestias ex consequatur voluptatibus veritatis inventore et quasi cum accusamus at ipsam, unde alias aperiam, dicta nesciunt eius ratione sint. Ullam, omnis? Exercitationem repellat, voluptatem doloribus cum ratione voluptatum quod perspiciatis maxime, officia enim ut accusamus soluta nesciunt optio recusandae! Saepe laboriosam id quo culpa at, placeat enim ullam! Soluta obcaecati vitae ratione eveniet, suscipit a repellendus, nemo nisi blanditiis praesentium in aliquid, officia beatae facilis accusantium sunt illum eos cupiditate voluptatibus error quam. Aperiam!

	<div id="widget">
	  <div class="widget-overlay"></div>
	  <div class="widget-container">
	    <div id="level"></div>
	    <div id="totalelo"></div>
	    <div id="amount"></div>
	  </div>
	</div>
	
	<script src="./js/libraries/jquery.min.js"></script>
	<script>
		$(document).ready(function() {
			// Отримуємо параметри totalelo та amount з URL-адреси
			const urlParams = new URLSearchParams(window.location.search);
			const totalElo = parseInt(urlParams.get('totalelo'));
			const amount = parseInt(urlParams.get('amount'));

			console.log(totalElo, amount);

			if (totalElo && amount) {
				updateStats(totalElo, amount);

				setTimeout(function() {
					updateELO(totalElo, amount)
				}, 1000);
			}
		});

		function updateStats(totalelo, amount) {
			var newElo = totalelo + amount;

			if (newElo < 0) {
			    newElo = 0;
			}

			var newLevel = getLevel(totalelo);
			var color = getColor(newLevel);

			$('#widget').show();
			$('#level').html(newLevel).css({
				'--color': color,
				'--p': 75/100 * newLevel * 10,
			}).addClass('anim');;
			$('#totalelo').html(`<span>${totalelo}</span>` + ' ELO');
			$('#amount').html((amount > 0 ? "+" : "") + amount + ' ELO').addClass(amount > 0 ? "green" : "red");

			setTimeout(function() {
				var newLevel = getLevel(newElo);
				var color = getColor(newLevel);

				$('#level').html(newLevel).css({
					'--color': color,
					'--a': 75/100 * newLevel * 10
				});
			}, 2000);

			setTimeout(function() {
				$('#widget').fadeOut();
			}, 4000);
		}

		function updateELO(totalelo, amount) {
		  // Calculate result and update totalelo
		  let result = totalelo + amount;
		  if (result < 0) {
		    result = 0;
		  }

		  // Animate totalelo update from current value to result
		  $("#totalelo span").animate(
		    {
		      num: result - totalelo,
		    },
		    {
		      duration: 1000,
		      step: function (num) {
		        this.innerHTML = Math.floor(num + totalelo);
		      },
		    }
		  );

		  // Hide amount after 2 seconds
		  setTimeout(function () {
		    $("#level").addClass('active');
		  }, 1000);
		}


		// Функція для визначення рівня за значенням ELO
		function getLevel(elo) {
		  if (elo >= 0 && elo <= 800) {
		    return 1;
		  } else if (elo >= 801 && elo <= 950) {
		    return 2;
		  } else if (elo >= 951 && elo <= 1100) {
		    return 3;
		  } else if (elo >= 1101 && elo <= 1250) {
		    return 4;
		  } else if (elo >= 1251 && elo <= 1400) {
		    return 5;
		  } else if (elo >= 1401 && elo <= 1550) {
		    return 6;
		  } else if (elo >= 1551 && elo <= 1700) {
		    return 7;
		  } else if (elo >= 1701 && elo <= 1850) {
		    return 8;
		  } else if (elo >= 1851 && elo <= 2000) {
		    return 9;
		  } else {
		    return 10;
		  }
		}

		function getColor(level) {
		  if (level == 1) {
		    return '#CDCDCD';
		  } else if (level >= 2 && level <= 3) {
		    return '#1CE400';
		  } else if (level >= 4 && level <= 7) {
		    return '#FFC800';
		  } else if (level >= 8 && level <= 9) {
		    return '#FF6309';
		  } else if (level == 10) {
		    return '#FE1F00';
		  }
		}
	</script>

</body>
</html>